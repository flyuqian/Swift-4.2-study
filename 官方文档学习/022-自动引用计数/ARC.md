#### 自动引用计数

- 工作机制

  > 当你每次创建一个类的新的实例时，ARC 会分配一块内存来存储这个实例信息。内存会包含该实例的类型信息，以及该实例所有相关的存储属性的值。
  >
  > 此外，当该实例不再使用时，ARC 会释放该实例所占的内存空间，以便内存回收使用。这就确保了不再被使用的实例不会一直占用内存空间。
  >
  > 然而，ARC 释放了的实例是不能再被访问属性或是调用方法的。实际上，如果你试图访问该实例，那你的应用程序很可能会崩溃。
  >
  > 为了确保实例正在使用的时候不会被释放，ARC 会跟踪记录每一个实例被属性、常量和变量所引用的次数。只要实例还被有效的引用着，ARC 就不会释放该实例。
  >
  > 为了实现这一点，在实例被分配给属性、常量或是变量的时候，这个属性、常量或是变量就会对该实例产生 *强引用*，这种引用之所以被称之为「 强 」引用，是因为它保持了对这个实例牢固的拥有关系，只要该强引用还存在，就不允许释放该实例。

- 引用循环

  - var a = A(); var b = B();  a.b = b; b.a = a;
  - 存储属性 用 `weak` `unowned` 修饰
  - weak 会将变量销毁后置为nil， 属性观察不调用
  - unowned 只有在确保引用的实例 *永远* 不会释放， 如果访问释放后的 unowned 对象，会引发运行时错误
  - 闭包循环引用，出在引用了self

- ​

  ​

  ​