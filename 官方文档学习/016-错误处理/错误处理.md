#### 错误处理

---

错误处理是响应错误以及从错误中恢复的过程。Swift 提供了在运行时对可恢复错误的抛出、捕获、传递和操作的一等公民支持。

- 表示和抛出错误

  - 错误 遵循 Error协议， Error是一个空协议，表明遵循该协议的类型可用于错误处理

- 处理错误

  - 使用抛出函数传递错误， 任何在非抛出函数中抛出错误必须在函数内部进行处理
  - 使用 do-catch 处理错误

  ```
  do {
      try expression
      statements
  } catch pattern 1 {
      statements
  } catch pattern 2 where condition {
      statements
  } catch {
      statements
  }
  ```

  - 使用 try? 将错误转换成 可选值来处理错误
  - 使用 try! 禁用错误传播，包调用过程包装在运行时断言中，若调用出现错误，则收到运行时错误

- 指定清理操作

  - 当代码执行到即将离开当前代码块之前，可以使用 `defer` 语句来执行一组语句。无论是因为错误而离开 --- 抑或是因为诸如 `return` 或 `break` 等语句而离开， `defer` 语句都可以让你执行一些必要的清理

  - `defer` 语句会推迟执行，直到退出当前作用域。该语句由 `defer` 关键字和稍后要执行的语句组成。延迟语句可能不包含任何将控制转移出语句的代码，例如 `break` 或 `return` 语句，或抛出错误。延迟操作的执行顺序与它们在源代码中编写的顺序相反。也就是说，第一个 `defer` 语句中的代码最后一个执行，第二个 `defer` 语句中的代码倒数第二个执行，依此类推。源代码中的最后一个 `defer` 语句最先执行。

    ​